rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Newsletter subscribers collection rules
    match /newsletter_subscribers/{subscriberId} {
      // Allow read access only to authenticated admin users
      allow read: if request.auth != null && request.auth.token.admin == true;
      
      // Allow create only from server-side (API routes)
      // This prevents direct client-side writes
      allow create: if false;
      
      // Allow update only from server-side for status changes
      allow update: if false;
      
      // Allow delete only for admin users
      allow delete: if request.auth != null && request.auth.token.admin == true;
    }
    
    // Default deny all other collections
    match /{document=**} {
      allow read, write: if false;
    }
  }
}